<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Tam Quốc Miêu H5 – Hướng dẫn cài đặt trên Linux</title>
<style>
  :root{
    --bg:#0f1115;
    --panel:#161a22;
    --card:#1d2330;
    --text:#e6eaf2;
    --muted:#9aa4b2;
    --accent:#6ee7ff;
    --accent2:#a78bfa;
    --ok:#22c55e;
    --warn:#f59e0b;
    --danger:#ef4444;
    --border:#2a3243;
    --code:#0b0f17;
  }
  *{box-sizing:border-box}
  html,body{margin:0;height:100%;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Be Vietnam Pro","Noto Sans",sans-serif}
  a{color:var(--accent);text-decoration:none}
  a:hover{opacity:.9;text-decoration:underline}
  .container{max-width:1100px;margin:0 auto;padding:24px}
  .banner{border:1px solid var(--border);background:linear-gradient(135deg,#0f1320, #121826 50%, #0f1320);padding:20px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.35);margin-bottom:24px}
  .banner h1{margin:0;font-size:28px;letter-spacing:.2px}
  .grid{display:grid;grid-template-columns:1fr;gap:14px;margin-top:14px}
  .pill{display:inline-flex;align-items:center;gap:10px;background:var(--card);border:1px solid var(--border);border-radius:999px;padding:10px 14px}
  .pill span{color:var(--muted);font-size:14px}
  .section{border:1px solid var(--border);background:var(--panel);border-radius:16px;margin:18px 0;overflow:hidden}
  .sec-hd{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;background:rgba(255,255,255,.02);border-bottom:1px solid var(--border)}
  .sec-hd h2{margin:0;font-size:18px;letter-spacing:.2px}
  .sec-bd{padding:16px 18px}
  .kvs{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .kv{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px}
  .kv .k{color:var(--muted);font-size:12px;text-transform:uppercase;letter-spacing:.6px}
  .kv .v{font-weight:600}
  .list{margin:0;padding-left:18px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px;margin:10px 0}
  pre{margin:0;background:var(--code);border:1px solid var(--border);border-radius:10px;overflow:auto}
  code{display:block;padding:12px 14px;line-height:1.5;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:13px;color:#c7e0ff;white-space:pre}
  .cmd{position:relative}
  .copy{position:absolute;top:10px;right:10px;font-size:12px;border:1px solid var(--border);background:var(--panel);color:var(--text);padding:6px 10px;border-radius:8px;cursor:pointer}
  .copy:hover{background:#202638}
  .note{color:var(--warn)}
  .ok{color:var(--ok)}
  .muted{color:var(--muted)}
  hr.sep{border:none;border-top:1px dashed var(--border);margin:18px 0}
  .footer{text-align:center;color:var(--muted);font-size:12px;margin-top:24px}
  @media (max-width: 800px){
    .kvs{grid-template-columns:1fr}
  }
</style>
</head>
<body>
  <div class="container">
    <header class="banner">
      <h1>🎮 Tam Quốc Miêu H5 – Hướng dẫn cài đặt trên Linux</h1>
      <div class="grid">
        <div class="pill">🌐 <span>WEBSITE:</span> <a href="https://loliteam.net/" target="_blank" rel="noopener">https://loliteam.net/</a></div>
        <div class="pill">📢 <span>TELEGRAM:</span> <a href="https://t.me/NhieKute" target="_blank" rel="noopener">https://t.me/NhieKute</a></div>
        <div class="pill">📘 <span>FACEBOOK:</span> <a href="https://www.facebook.com/Thuong.EoPi" target="_blank" rel="noopener">/Thuong.EoPi</a></div>
        <div class="pill">👨‍💻 <span>Phát triển:</span> <strong>Eopi Noriko</strong> from <strong>LoLi Team</strong></div>
      </div>
    </header>

    <section class="section">
      <div class="sec-hd"><h2>Thông tin hệ thống</h2></div>
      <div class="sec-bd kvs">
        <div class="kv"><div class="k">Hệ điều hành</div><div class="v">CentOS 7.9</div></div>
        <div class="kv"><div class="k">Demo IP</div><div class="v">36.50.134.243</div></div>
      </div>
    </section>

    <section class="section">
      <div class="sec-hd"><h2>🔧 Cài đặt aaPanel 7</h2></div>
      <div class="sec-bd">
        <p>Chạy lệnh sau (một dòng):</p>
        <div class="cmd">
          <button class="copy" data-target="cmd-aapanel">Copy</button>
          <pre><code id="cmd-aapanel">URL=https://loliteam.net/install_7.0_en_pro.sh && if [ -f /usr/bin/curl ];then curl -ksSO "$URL" ;else wget --no-check-certificate -O install_7.0_en_pro.sh "$URL";fi;bash install_7.0_en_pro.sh aapanel</code></pre>
        </div>
        <p class="note">👉 Khi có thông báo: nhập <code>y</code> (chữ thường) rồi Enter để xác nhận.</p>
      </div>
    </section>

    <section class="section">
      <div class="sec-hd"><h2>🛠️ Cài đặt môi trường</h2></div>
      <div class="sec-bd">
        <ul class="list">
          <li>Nginx 1.22</li>
          <li>MySQL 5.6</li>
          <li>PHP 7.4 – cài extension: <strong>ionCube</strong> + <strong>memcache</strong> → reload config → restart PHP</li>
          <li>Docker engine</li>
          <li>Elasticsearch</li>
          <li>Linux Toolbox – Setting → Swap/Virtual memory: <strong>5120</strong> (tuỳ cấu hình server)</li>
        </ul>
      </div>
    </section>

    <section class="section">
      <div class="sec-hd"><h2>🔓 Mở port Firewall</h2></div>
      <div class="sec-bd">
        <p>Cần mở các port: <strong>80, 81, 82, 8192, 8193, 9200, 10001, 10002</strong></p>
      </div>
    </section>

    <section class="section">
      <div class="sec-hd"><h2>📦 Upload &amp; giải nén server</h2></div>
      <div class="sec-bd">
        <div class="card">Upload file <code>Server-MeoMeo-Eopi.zip</code> vào thư mục gốc <code>/</code></div>
        <div class="cmd">
          <button class="copy" data-target="cmd-unzip">Copy</button>
          <pre><code id="cmd-unzip">cd / && unzip Server-MeoMeo-Eopi.zip</code></pre>
        </div>
        <p class="note">⚠️ Trước khi giải nén cần đảm bảo Nginx đã cài thành công.</p>
        <hr class="sep">
        <p>Sửa file cấu hình Nginx:</p>
        <div class="card"><code>/www/server/panel/vhost/nginx/127.0.0.1.conf</code><br>→ Thay <code>meomeo.jx2jaya.com</code> bằng IP hoặc domain của bạn.</div>
        <div class="cmd">
          <button class="copy" data-target="cmd-nginx-restart">Copy</button>
          <pre><code id="cmd-nginx-restart">/etc/init.d/nginx restart</code></pre>
        </div>
        <div class="cmd">
          <button class="copy" data-target="cmd-chmod1">Copy</button>
          <pre><code id="cmd-chmod1">chmod -R 777 /data</code></pre>
        </div>
        <div class="cmd">
          <button class="copy" data-target="cmd-chmod2">Copy</button>
          <pre><code id="cmd-chmod2">chmod -R 777 /www/wwwroot/game</code></pre>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="sec-hd"><h2>📝 Sửa IP server</h2></div>
      <div class="sec-bd">
        <p>Thay IP <code>36.50.134.243</code> trong các file sau:</p>
        <ul class="list">
          <li>/data/sql/cat_center.sql</li>
          <li>/data/sql/game_admin.sql</li>
          <li>/www/wwwroot/game/index.php</li>
        </ul>
      </div>
    </section>

    <section class="section">
      <div class="sec-hd"><h2>🌍 Cấu hình domain (nếu cần)</h2></div>
      <div class="sec-bd">
        <div class="card">File: <code>/www/wwwroot/game/index.php</code><br>→ Thay <code>meomeo.jx2jaya.com</code> bằng domain của bạn.</div>
        <ul class="list">
          <li>aaPanel → Website → Add site</li>
          <li>Domain: nhập domain</li>
          <li>Website Path: <code>/www/wwwroot/game</code></li>
        </ul>
      </div>
    </section>

    <section class="section">
      <div class="sec-hd"><h2>💾 Database</h2></div>
      <div class="sec-bd">
        <div class="card">Đổi mật khẩu DB thành: <code>123456</code></div>
        <div class="cmd">
          <button class="copy" data-target="cmd-import-db">Copy</button>
          <pre><code id="cmd-import-db">cd /data/sql && ./add-dtb.sh</code></pre>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="sec-hd"><h2>🍃 Cài MongoDB</h2></div>
      <div class="sec-bd">
        <ol class="list">
          <li>
            <strong>Import image</strong><br>
            Docker → Local image → Import image<br>
            Path: <code>/data/3qmeomeo-mongo40-eopi.tar</code> → Confirm
          </li>
          <li>
            <strong>Tạo container</strong><br>
            Docker → Container → Create Container → Command create<br>
            Nhập lệnh (một dòng):
            <div class="cmd">
              <button class="copy" data-target="cmd-docker">Copy</button>
              <pre><code id="cmd-docker">docker run -d --name mongo40 -p 127.0.0.1:27017:27017 -v /data/mongo40:/data/db mongo:4.0.28 --bind_ip_all</code></pre>
            </div>
            Execute command
          </li>
          <li>
            <strong>Kiểm tra container</strong>
            <div class="cmd">
              <button class="copy" data-target="cmd-netstat">Copy</button>
              <pre><code id="cmd-netstat">netstat -tulpn</code></pre>
            </div>
            👉 Nếu thấy port <code>27017</code> đang chạy → <span class="ok">OK</span>
          </li>
        </ol>
      </div>
    </section>

    <section class="section">
      <div class="sec-hd"><h2>⚙️ Sửa Backend API</h2></div>
      <div class="sec-bd">
        <ul class="list">
          <li>Software Store → elasticsearch → <strong>权限</strong><br>→ Copy mật khẩu <strong>管理员密码</strong> vào file cấu hình backend:<br><code>/data/gmhoutai/gameadmin/.env</code> (dòng <strong>56</strong>)</li>
          <li>Đổi cả thông tin tài khoản admin và mật khẩu 123456 trước khi lưu lại</li>
          <li>Software Store → elasticsearch → <strong>配置文件</strong><br>→ Tìm: <code>xpack.security.http.ssl:</code><br>→ Đổi <code>enabled: true</code> → <code>enabled: false</code> → Save</li>
        </ul>
      </div>
    </section>

    <section class="section">
      <div class="sec-hd"><h2>🚀 Khởi động / Dừng server</h2></div>
      <div class="sec-bd">
        <p class="note">Lệnh chạy server và chạy liên server.</p>
        <div class="cmd"><button class="copy" data-target="cmd-start1">Sao chép</button><pre><code id="cmd-start1">cd /data/server/bin && ./run.sh</code></pre></div>
        <div class="cmd"><button class="copy" data-target="cmd-start2">Sao chép</button><pre><code id="cmd-start2">cd /data/cross/bin && ./run.sh</code></pre></div>
        <p class="note">Kiểm tra xem game đã chạy hay chưa.</p>
        <div class="cmd"><button class="copy" data-target="cmd-check">Sao chép</button><pre><code id="cmd-check">netstat -lntp</code></pre></div>
        <p class="note">Lệnh tắt server (server) và tắt liên server (cross).</p>
        <div class="cmd"><button class="copy" data-target="cmd-stop1">Sao chép</button><pre><code id="cmd-stop1">cd /data/server/bin && ./stop.sh</code></pre></div>
        <div class="cmd"><button class="copy" data-target="cmd-stop2">Sao chép</button><pre><code id="cmd-stop2">cd /data/cross/bin && ./stop.sh</code></pre></div>
      </div>
    </section>

    <section class="section">
      <div class="sec-hd"><h2>🎮 Đường dẫn game &amp; backend</h2></div>
      <div class="sec-bd">
        <ul class="list">
          <li>Game: <code>http://IP:81</code> — nếu có domain: <code>http://tenmien.com</code></li>
          <li>Android client: thay IP <code>36.50.134.243</code> tại <code>\assets\apps\H59BB7BF3\www\manifest.json</code></li>
          <li>GM Backend: <code>http://IP:81/QuanTriVip/gm.php</code> — GM code: <strong>ThuongEopi</strong></li>
          <li>User Backend: <code>http://IP:81/gm</code></li>
          <li>Admin Backend: <code>http://IP:82/module/login.php</code> — Tài khoản: <strong>admin</strong> — Mật khẩu: <strong>123456</strong></li>
          <li><b>⚔️ Bật các tính năng đấu trường &amp; liên server</b>:<br>
            Đăng nhập Admin backend port <b>82</b> → Menu trái → Sửa thời gian mở server → Chọn ngày giờ → Bấm nút <b>cài đặt</b>!</li>
        </ul>
      </div>
    </section>

    <p class="footer">© LoLi Team • Hướng dẫn được biên soạn bởi Eopi Noriko</p>
  </div>

<script>
  document.querySelectorAll('.copy').forEach(btn => {
    btn.addEventListener('click', () => {
      const id = btn.getAttribute('data-target');
      const el = document.getElementById(id);
      if(!el) return;
      const txt = el.innerText;
      navigator.clipboard.writeText(txt).then(()=>{
        const old = btn.textContent;
        btn.textContent = 'Đã copy';
        btn.style.borderColor = 'var(--ok)';
        setTimeout(()=>{btn.textContent = 'Copy'; btn.style.borderColor='var(--border)';}, 1300);
      }).catch(()=>{
        btn.textContent = 'Lỗi copy';
        btn.style.borderColor = 'var(--danger)';
        setTimeout(()=>{btn.textContent = 'Copy'; btn.style.borderColor='var(--border)';}, 1300);
      });
    });
  });
</script>
</body>
</html>
